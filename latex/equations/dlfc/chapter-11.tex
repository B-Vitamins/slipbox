\documentclass{article}

% Document Layout and Fonts
\usepackage[margin=0.9in]{geometry}    % Page margins
\usepackage{fontspec}                  % For custom fonts (LuaLaTeX feature)
\usepackage{tgpagella}
\usepackage{mathpazo}
\setmainfont{EB Garamond}              % Main font (EB Garamond)
\usepackage{microtype}                 % Improves text appearance
\usepackage{titlesec}                  % Customize section title fonts

% Right-align section headings
\titleformat{\section}
  {\normalfont\large\scshape\raggedright}  % Right-align and small caps
  {}{0em}{}[]

% Right-align subsection headings and add a line below
\titleformat{\subsection}
  {\normalfont\normalsize\raggedleft}     % Right-align subsections
  {}{0em}{\titlerule[0.5pt]}              % Horizontal line below

% Right-align and italicize subsubsections
\titleformat{\subsubsection}
  {\normalfont\normalsize\itshape\raggedleft} % Right-align and italicize subsubsections
  {}{0em}{}[]

% Math and Science Packages
\usepackage{amsmath, amsfonts, amssymb, mathtools, amsthm, dsfont}

% Math commands and operators
\newcommand{\minus}{\scalebox{0.8}{\(-\)}}
\newcommand{\plus}{\scalebox{0.6}{\(+\)}}
\DeclareMathOperator{\sech}{sech}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\tr}{Tr}
\newcommand{\diff}{\mathop{}\!\mathrm{d}}    % Differential d

% Definitions, theorems, corollaries, and friends
\usepackage[english]{babel}
\usepackage[hidelinks]{hyperref}
\newtheorem{axiom}{Axiom}
\newtheorem{postulate}{Postulate}
\newtheorem{definition}{Definition}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem*{remark}{Remark}

\title{\LARGE\scshape\MakeUppercase{Chapter 11: Structured Distributions}}
\author{\textit{Bishop and Bishop}}
\date{}

\begin{document}

\maketitle

\begin{align*}
p(t \mid \mathbf{x}, \mathbf{w})=y(\mathbf{x}, \mathbf{w})^{t}\{1-y(\mathbf{x}, \mathbf{w})\}^{(1-t)} \tag{11.1}
\end{align*}

\section{Graphical Models}

\subsection{Directed graphs}
No equations

\subsection{Factorization}

\begin{align*}
p(a, b, c) = p(c \mid a, b) p(a, b) 
\tag{11.2}
\end{align*}

\begin{align*}
p(a, b, c)=p(c \mid a, b) p(b \mid a) p(a) 
\tag{11.3}
\end{align*}

\begin{align*}
p\left(x_{1}, \ldots, x_{K}\right)=p\left(x_{K} \mid x_{1}, \ldots, x_{K-1}\right) \ldots p\left(x_{2} \mid x_{1}\right) p\left(x_{1}\right)
\tag{11.4}
\end{align*}

\begin{align*}
p\left(x_{1}, x_{2}, \ldots, x_{7}\right)=p\left(x_{1}\right) p\left(x_{2}\right) p\left(x_{3}\right) p\left(x_{4} \mid x_{1}, x_{2}, x_{3}\right) p\left(x_{5} \mid x_{1}, x_{3}\right) p\left(x_{6} \mid x_{4}\right) p\left(x_{7} \mid x_{4}, x_{5}\right) 
\tag{11.5}
\end{align*}

\begin{align*}
p\left(x_{1}, \ldots, x_{K}\right)=\prod_{k=1}^{K} p\left(x_{k} \mid \mathrm{pa}(k)\right)
\tag{11.6}
\end{align*}

\subsection{Discrete variables}

\begin{align*}
p(\mathbf{x} \mid \boldsymbol{\mu})=\prod_{k=1}^{K} \mu_{k}^{x_{k}}
\tag{11.7}
\end{align*}

\begin{align*}
p\left(\mathbf{x}_{1}, \mathbf{x}_{2} \mid \boldsymbol{\mu}\right)=\prod_{k=1}^{K} \prod_{l=1}^{K} \mu_{k l}^{x_{1 k} x_{2 l}}
\tag{11.8}
\end{align*}

\begin{align*}
p\left(y=1 \mid x_{1}, \ldots, x_{M}\right)=\sigma\left(w_{0}+\sum_{i=1}^{M} w_{i} x_{i}\right)=\sigma\left(\mathbf{w}^{\top} \mathbf{x}\right)
\tag{11.9}
\end{align*}

\subsection{Gaussian variables}

\begin{align*}
p\left(x_{i} \mid \operatorname{pa}(i)\right)=\mathcal{N}\left(x_{i} \mid \sum_{j \in \mathrm{pa}(i)} w_{i j} x_{j}+b_{i}, v_{i}\right)
\tag{11.10}
\end{align*}

\begin{align*}
\ln p(\mathbf{x}) =\sum_{i=1}^{D} \ln p\left(x_{i} \mid \mathrm{pa}(i)\right)  
\tag{11.11}
\end{align*}

\begin{align*}
\ln p(\mathbf{x}) =-\sum_{i=1}^{D} \frac{1}{2 v_{i}}\left(x_{i}-\sum_{j \in \mathrm{pa}(i)} w_{i j} x_{j}-b_{i}\right)^{2}+\mathrm{const}
\tag{11.12}
\end{align*}

\begin{align*}
\mathbb{E}\left[
x_{i}\right]
=\sum_{j \in \mathrm{pa}(i)} w_{i j} \mathbb{E}\left[
x_{j}\right]
+b_{i} 
\tag{11.13}
\end{align*}

\begin{align*}
\operatorname{cov}\left[
x_{i}, x_{j}\right]
=\sum_{k \in \mathrm{pa}(j)} w_{j k} \operatorname{cov}\left[
x_{i}, x_{k}\right]
+I_{i j} v_{j}
\tag{11.14}
\end{align*}

\begin{align*}
\boldsymbol{\mu}=\left(b_{1}, b_{2}+w_{21} b_{1}, b_{3}+w_{32} b_{2}+w_{32} w_{21} b_{1}\right)^{\top} 
\tag{11.15}
\end{align*}

\begin{align*}
\boldsymbol{\Sigma}=\left(\begin{array}{ccc}
v_{1} & w_{21} v_{1} & w_{32} w_{21} v_{1} \\
w_{21} v_{1} & v_{2}+w_{21}^{2} v_{1} & w_{32}\left(v_{2}+w_{21}^{2} v_{1}\right) \\
w_{32} w_{21} v_{1} & w_{32}\left(v_{2}+w_{21}^{2} v_{1}\right) & v_{3}+w_{32}^{2}\left(v_{2}+w_{21}^{2} v_{1}\right)
\end{array}
\right)
\tag{11.16}
\end{align*}

\begin{align*}
p\left(\mathbf{x}_{i} \mid \operatorname{pa}(i)\right)=\mathcal{N}\left(\mathbf{x}_{i} \mid \sum_{j \in \mathrm{pa}(i)} \mathbf{W}_{i j} \mathbf{x}_{j}+\mathbf{b}_{i}, \boldsymbol{\Sigma}_{i}\right)
\tag{11.17}
\end{align*}

\subsection{Binary classifier}

\begin{align*}
p(\mathbf{t}, \mathbf{w} \mid \mathbf{X}, \lambda)=p(\mathbf{w} \mid \lambda) \prod_{n=1}^{N} p\left(t_{n} \mid \mathbf{w}, \mathbf{x}_{n}\right)
\tag{11.18}
\end{align*}

\begin{align*}
p(\mathbf{w} \mid \lambda)=\mathcal{N}(\mathbf{w} \mid \mathbf{0}, \lambda \mathbf{I})
\tag{11.19}
\end{align*}

\begin{align*}
p(\widehat{t}, \mathbf{t}, \mathbf{w} \mid \widehat{x}, \mathbf{X}, \lambda)=p(\mathbf{w} \mid \lambda) p(\widehat{t} \mid \mathbf{w}, \widehat{x}) \prod_{n=1}^{N} p\left(t_{n} \mid \mathbf{w}, \mathbf{x}_{n}\right)
\tag{11.20}
\end{align*}

\subsection{Bayes' theorem}

\begin{align*}
p(y)=\sum_{x^{\prime}} p\left(y \mid x^{\prime}\right) p\left(x^{\prime}\right) 
\tag{11.21}
\end{align*}

\begin{align*}
p(x \mid y)=\frac{p(y \mid x) p(x)}{p(y)}
\tag{11.22}
\end{align*}


\section{Conditional Independence}

\begin{align*}
p(a \mid b, c)=p(a \mid c) 
\tag{11.22}
\end{align*}

\begin{align*}
p(a, b \mid c) = p(a \mid b, c) p(b \mid c) = p(a \mid c) p(b \mid c) 
\tag{11.23}
\end{align*}

\begin{align*}
a \perp b \mid c 
\tag{11.24}
\end{align*}

\subsection{Three example graphs}

\begin{align*}
p(a, b, c)=p(a \mid c) p(b \mid c) p(c) 
\tag{11.25}
\end{align*}

\begin{align*}
p(a, b)=\sum_{c} p(a \mid c) p(b \mid c) p(c) 
\tag{11.26}
\end{align*}

\begin{align*}
a \not \Perp b \mid \emptyset 
\tag{11.27}
\end{align*}

\begin{align*}
p(a, b, c)=p(a) p(c \mid a) p(b \mid c) 
\tag{11.28}
\end{align*}

\begin{align*}
a \not \perp b \mid \emptyset 
\tag{11.29}
\end{align*}

\begin{align*}
p(a, b, c)=p(a) p(b) p(c \mid a, b) 
\tag{11.30}
\end{align*}

\begin{align*}
a \perp b \mid \emptyset 
\tag{11.31}
\end{align*}

\subsection{Explaining away}

\begin{align*}
p(G=0)=\sum_{B \in\{0,1\}} \sum_{F \in\{0,1\}} p(G=0 \mid B, F) p(B) p(F)=0.315 
\tag{11.32}
\end{align*}

\begin{align*}
p(G=0 \mid F=0)=\sum_{B \in\{0,1\}} p(G=0 \mid B, F=0) p(B)=0.81 
\tag{11.33}
\end{align*}

\begin{align*}
p(F=0 \mid G=0)=\frac{p(G=0 \mid F=0) p(F=0)}{p(G=0)} \simeq 0.257 
\tag{11.34}
\end{align*}

\begin{align*}
p(F=0 \mid G=0, B=0)=\frac{p(G=0 \mid B=0, F=0) p(F=0)}{\sum_{F \in\{0,1\}} p(G=0 \mid B=0, F) p(F)} \simeq 0.111 
\tag{11.35}
\end{align*}

\subsection{D-separation}

\begin{align*}
\hat{t} \perp t_{n} \mid \mathbf{w} 
\tag{11.36}
\end{align*}

\subsection{Naive Bayes}

\begin{align*}
p\left(\mathbf{x} \mid \mathcal{C}_{k}\right)=\prod_{l=1}^{L} p\left(\mathbf{x}^{(l)} \mid \mathcal{C}_{k}\right) 
\tag{11.37}
\end{align*}

\begin{align*}
p\left(\mathcal{C}_{k} \mid \mathbf{x}\right)=\frac{p\left(\mathbf{x} \mid \mathcal{C}_{k}\right) p\left(\mathcal{C}_{k}\right)}{p(\mathbf{x})} 
\tag{11.38}
\end{align*}

\begin{align*}
p(\mathbf{x})=\sum_{k=1}^{K} p\left(\mathbf{x} \mid \mathcal{C}_{k}\right) p\left(\mathcal{C}_{k}\right) 
\tag{11.39}
\end{align*}

\begin{align*}
p\left(\mathbf{x} \mid \mathcal{C}_{k}\right)=p\left(x_{1} \mid \mathcal{C}_{k}\right) p\left(x_{2} \mid \mathcal{C}_{k}\right) 
\tag{11.40}
\end{align*}

\begin{align*}
p(\mathbf{x})=\sum_{k=1}^{K} p\left(\mathbf{x} \mid \mathcal{C}_{k}\right) p\left(\mathcal{C}_{k}\right) 
\tag{11.41}
\end{align*}

\subsection{Generative models}

No equations

\subsection{Markov blanket}

No equations

\subsection{Graphs as filters}

No equations

\section{Sequence Models}

\begin{align*}
p\left(\mathbf{x}_{1}, \ldots, \mathbf{x}_{N}\right)=\prod_{n=1}^{N} p\left(\mathbf{x}_{n} \mid \mathbf{x}_{1}, \ldots, \mathbf{x}_{n-1}\right) 
\tag{11.42}
\end{align*}

\begin{align*}
p\left(\mathbf{x}_{1}, \ldots, \mathbf{x}_{N}\right)=\prod_{n=1}^{N} p\left(\mathbf{x}_{n}\right) 
\tag{11.43}
\end{align*}

\begin{align*}
p\left(\mathbf{x}_{1}, \ldots, \mathbf{x}_{N}\right)=p\left(\mathbf{x}_{1}\right) \prod_{n=2}^{N} p\left(\mathbf{x}_{n} \mid \mathbf{x}_{n-1}\right) 
\tag{11.44}
\end{align*}

\begin{align*}
p\left(\mathbf{x}_{n} \mid \mathbf{x}_{1}, \ldots, \mathbf{x}_{n-1}\right)=p\left(\mathbf{x}_{n} \mid \mathbf{x}_{n-1}\right) 
\tag{11.45}
\end{align*}

\begin{align*}
p\left(\mathbf{x}_{1}, \ldots, \mathbf{x}_{N}\right)=p\left(\mathbf{x}_{1}\right) p\left(\mathbf{x}_{2} \mid \mathbf{x}_{1}\right) \prod_{n=3}^{N} p\left(\mathbf{x}_{n} \mid \mathbf{x}_{n-1}, \mathbf{x}_{n-2}\right) 
\tag{11.46}
\end{align*}

\subsection{Hidden variables}

\begin{align*}
\mathbf{z}_{n+1} \perp \mathbf{z}_{n-1} \mid \mathbf{z}_{n} 
\tag{11.47}
\end{align*}

\begin{align*}
p\left(\mathbf{x}_{1}, \ldots, \mathbf{x}_{N}, \mathbf{z}_{1}, \ldots, \mathbf{z}_{N}\right)=p\left(\mathbf{z}_{1}\right)\left[
\prod_{n=2}^{N} p\left(\mathbf{z}_{n} \mid \mathbf{z}_{n-1}\right)\right]
\prod_{n=1}^{N} p\left(\mathbf{x}_{n} \mid \mathbf{z}_{n}\right) 
\tag{11.48}
\end{align*}

\end{document}
